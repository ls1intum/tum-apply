<!-- Confirm Dialogs -->
<jhi-confirm-dialog
  #editPublishedDialog
  [label]="'button.edit' | translate"
  [header]="'myPositionsPage.confirmDialog.editJobHeader' | translate"
  [message]="'myPositionsPage.confirmDialog.editJobMessage' | translate"
  severity="primary"
  confirmIcon="pencil"
  [showOpenButton]="false"
  (confirmed)="onConfirmEdit()"
/>

<jhi-confirm-dialog
  #deleteDialog
  [label]="'button.delete' | translate"
  [header]="'myPositionsPage.confirmDialog.deleteHeader' | translate"
  [message]="'myPositionsPage.confirmDialog.deleteMessage' | translate"
  severity="danger"
  confirmIcon="trash"
  [showOpenButton]="false"
  (confirmed)="onConfirmDelete()"
/>

<jhi-confirm-dialog
  #closeDialog
  [label]="'button.close' | translate"
  [header]="'myPositionsPage.confirmDialog.closeHeader' | translate"
  [message]="'myPositionsPage.confirmDialog.closeMessage' | translate"
  severity="danger"
  confirmIcon="xmark"
  [showOpenButton]="false"
  (confirmed)="onConfirmClose()"
/>

<div class="page-container">
  <div class="header-container">
    <div class="page-header">
      <h1>
        <span jhiTranslate="sidebar.recruitment.title"></span>
        -
        <span jhiTranslate="myPositionsPage.header.title"></span>
      </h1>
    </div>
    <jhi-button
      label="myPositionsPage.header.createButton"
      icon="plus"
      severity="primary"
      (click)="onCreateJob()"
      [shouldTranslate]="true"
    />
  </div>
  <div class="my-positions-container">
    <div class="body">
      <jhi-search-filter-sort-bar
        [searchText]="'myPositionsPage.searchFilterSortBar.searchText' | translate"
        [totalRecords]="totalRecords()"
        [singleEntity]="'job' | translate"
        [multipleEntities]="'jobs' | translate"
        (searchOutput)="onSearchEmit($event)"
        (filterOutput)="onFilterEmit($event)"
        (sortOutput)="loadOnSortEmit($event)"
        [filters]="[
          {
            filterId: 'status',
            filterLabel: 'myPositionsPage.tableColumn.status',
            filterSearchPlaceholder: 'myPositionsPage.searchFilterSortBar.filterOptions.stateSearchPlaceholder',
            filterOptions: availableStatusLabels,
            shouldTranslateOptions: true,
          },
        ]"
        [sortableFields]="sortableFields"
      />
      <div class="table-wrapper">
        <jhi-dynamic-table
          [columns]="columns()"
          [data]="jobs()"
          [totalRecords]="totalRecords()"
          [page]="page()"
          [rows]="pageSize()"
          [selectable]="false"
          (lazyLoad)="loadOnTableEmit($event)"
        />
      </div>

      <!-- Templates for localized date rendering -->
      <ng-template #startDateTemplate let-job>
        {{ (job.startDate?.toString() | localizedDate) || '-' }}
      </ng-template>
      <ng-template #createdAtTemplate let-job>
        {{ (job.createdAt?.toString() | localizedDate) || '-' }}
      </ng-template>
      <ng-template #lastModifiedAtTemplate let-job>
        {{ (job.lastModifiedAt?.toString() | localizedDate) || '-' }}
      </ng-template>

      <ng-template #actionTemplate let-job>
        <div class="flex justify-end gap-1">
          <jhi-button [tooltip]="'button.view' | translate" icon="eye" variant="text" (click)="onViewJob(job.jobId)" />
          <jhi-button
            [tooltip]="getMenuItems()(job).length > 0 ? ('button.actions' | translate) : ('button.noFurtherActions' | translate)"
            icon="ellipsis-vertical"
            variant="text"
            (click)="menu.toggle($event)"
            [disabled]="getMenuItems()(job).length === 0"
          />
          <jhi-menu #menu [items]="getMenuItems()(job)" [shouldTranslate]="true" />
        </div>
      </ng-template>

      <ng-template #stateTemplate let-job>
        <jhi-tag
          [text]="stateTextMap()[job.state] ? (stateTextMap()[job.state] | translate) : ('jobState.unknown' | translate)"
          [color]="stateSeverityMap()[job.state] || 'info'"
          width="8rem"
        />
      </ng-template>
    </div>
  </div>
</div>
