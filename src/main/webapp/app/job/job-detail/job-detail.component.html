<jhi-confirm-dialog
  #closeConfirmDialog
  class="confirm-dialog"
  [header]="'myPositionsPage.confirmDialog.closeHeader' | translate"
  [message]="'myPositionsPage.confirmDialog.closeMessage' | translate"
  [label]="closeButtonLabel | translate"
  variant="outlined"
  [severity]="closeButtonSeverity"
  [confirmIcon]="closeButtonIcon"
  [showOpenButton]="false"
  (confirmed)="onCloseJob()"
/>
<jhi-confirm-dialog
  #deleteConfirmDialog
  class="confirm-dialog"
  [header]="'myPositionsPage.confirmDialog.deleteHeader' | translate"
  [message]="'myPositionsPage.confirmDialog.deleteMessage' | translate"
  [label]="deleteButtonLabel | translate"
  [severity]="deleteButtonSeverity"
  [confirmIcon]="deleteButtonIcon"
  [showOpenButton]="false"
  (confirmed)="onDeleteJob()"
/>
@if (dataLoaded()) {
  <div [class]="isSummaryPage() ? '' : 'page-container'">
    <header class="job-header">
      <div class="header-content">
        <div class="header-left">
          <h1 class="job-title">{{ jobDetails()?.title }}</h1>
          <div class="job-meta-info">
            <div class="meta-item">
              <fa-icon [icon]="['fas', 'user-tie']" class="meta-icon" />
              <span><strong>Supervisor: </strong>{{ jobDetails()?.supervisingProfessor || noData() }}</span>
            </div>
            <div class="meta-item">
              <fa-icon [icon]="['fas', 'location-dot']" class="meta-icon" />
              <span><strong>Location: </strong>{{ jobDetails()?.location || noData() }}</span>
            </div>
          </div>
        </div>
        <div class="header-right">
          @if (rightActionButtons()) {
            <jhi-button-group [data]="rightActionButtons()!" [shouldTranslate]="true" />
          }
          <!-- display job state if the logged-in user belongs to the research group, display draft if form is in preview -->
          @if (previewData()) {
            <jhi-tag class="job-state-badge" [text]="'jobState.preview' | translate" [color]="'info'" />
          } @else if (jobDetails()?.belongsToResearchGroup) {
            <jhi-tag class="job-state-badge" [text]="jobStateText | translate" [color]="jobStateColor" />
          }
        </div>
      </div>
    </header>

    <!-- Main Content Grid -->
    <div class="content-grid">
      <!-- Left Column: Text Sections -->
      <div class="left-column">
        <section class="text-section">
          <h2 class="section-title">Job Description</h2>
          @if (jobDetails()?.description !== '') {
            <div class="section-content" [innerHTML]="jobDetails()?.description"></div>
          } @else {
            <div class="section-content">{{ noData() }}</div>
          }
        </section>

        <section class="text-section">
          <h2 class="section-title">Tasks & Responsibilities</h2>
          @if (jobDetails()?.tasks !== '') {
            <div class="section-content" [innerHTML]="jobDetails()?.tasks"></div>
          } @else {
            <div class="section-content">{{ noData() }}</div>
          }
        </section>

        <section class="text-section">
          <h2 class="section-title">Eligibility Criteria</h2>
          @if (jobDetails()?.requirements !== '') {
            <div class="section-content" [innerHTML]="jobDetails()?.requirements"></div>
          } @else {
            <div class="section-content">{{ noData() }}</div>
          }
        </section>
      </div>

      <!-- Right Column: Cards -->
      <div class="right-column">
        <div class="detail-card">
          <div class="card-header">
            <fa-icon [icon]="['fas', 'briefcase']" class="icon" />
            <h3 class="card-title">Position Overview</h3>
          </div>
          <div class="card-body">
            <div class="info-list">
              <div class="info-row">
                <span class="label">Field of Studies</span>
                <span class="value">{{ jobDetails()?.fieldOfStudies || noData() }}</span>
              </div>
              <div class="info-row">
                <span class="label">Research Area</span>
                <span class="value">{{ jobDetails()?.researchArea || noData() }}</span>
              </div>
              <div class="info-row">
                <span class="label">Workload</span>
                @if (jobDetails()?.workload !== '') {
                  <span class="value">{{ jobDetails()?.workload }} hours/week</span>
                } @else {
                  <span class="value">{{ noData() }}</span>
                }
              </div>
              <div class="info-row">
                <span class="label">Contract Duration</span>
                @if (jobDetails()?.contractDuration !== '') {
                  <span class="value">{{ jobDetails()?.contractDuration }} years</span>
                } @else {
                  <span class="value">{{ noData() }}</span>
                }
              </div>
              <div class="info-row">
                <span class="label">Funding Type</span>
                <span class="value">{{ jobDetails()?.fundingType || noData() }}</span>
              </div>
              <div class="info-row">
                <span class="label">Start Date</span>
                <span class="value">{{ jobDetails()?.startDate || noData() }}</span>
              </div>
              @if (jobDetails()?.endDate) {
                <div class="info-row">
                  <span class="label">Application End Date</span>
                  <span class="value end-date">{{ jobDetails()?.endDate }}</span>
                </div>
              }
            </div>
          </div>
        </div>

        <div class="detail-card">
          <div class="card-header">
            <fa-icon [icon]="['fas', 'users']" class="icon" />
            <h3 class="card-title">Research Group</h3>
          </div>
          <div class="card-body">
            <h4 class="research-group-name">{{ jobDetails()?.researchGroup || noData() }}</h4>
            @if (jobDetails()?.researchGroupDescription !== '') {
              <div class="research-group-description" [innerHTML]="jobDetails()?.researchGroupDescription"></div>
            } @else {
              <div class="research-group-description">{{ noData() }}</div>
            }

            @if (jobDetails()?.researchGroupEmail || jobDetails()?.researchGroupWebsite || jobDetails()?.researchGroupStreet) {
              <div class="contact-info">
                @if (jobDetails()?.researchGroupStreet) {
                  <div class="contact-item">
                    <fa-icon [icon]="['fas', 'location-dot']" class="icon" />
                    <div>
                      <div>{{ jobDetails()?.researchGroupStreet }}</div>
                      <div>{{ jobDetails()?.researchGroupPostalCode }} {{ jobDetails()?.researchGroupCity }}</div>
                    </div>
                  </div>
                }
                @if (jobDetails()?.researchGroupEmail) {
                  <div class="contact-item">
                    <fa-icon [icon]="['fas', 'envelope']" class="icon" />
                    <a class="link" [href]="'mailto:' + jobDetails()?.researchGroupEmail">{{ jobDetails()?.researchGroupEmail }}</a>
                  </div>
                }
                @if (jobDetails()?.researchGroupWebsite) {
                  <div class="contact-item">
                    <fa-icon [icon]="['fas', 'globe']" class="icon" />
                    <a class="link" [href]="jobDetails()?.researchGroupWebsite" target="_blank" rel="noopener noreferrer">{{
                      jobDetails()?.researchGroupWebsite
                    }}</a>
                  </div>
                }
              </div>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Data Protection Information -->
    <section class="data-protection-section">
      <h2 class="section-title">Data Protection Information</h2>
      <div class="data-protection-content" [innerHTML]="'jobDetailPage.dataPrivacy.dataProtectionText' | translate"></div>
    </section>

    @if (!previewData()) {
      <section class="action-buttons-section">
        <div class="button-wrapper">
          <jhi-button label="jobActionButton.back" severity="info" variant="outlined" (click)="onBack()" [shouldTranslate]="true" />
        </div>
      </section>
    }
  </div>
}
