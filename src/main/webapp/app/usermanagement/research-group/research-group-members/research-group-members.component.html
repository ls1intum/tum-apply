<div class="research-group-members">
  <div class="header">
    <h1 jhiTranslate="researchGroup.memberHeader">Members</h1>
  </div>

  <!-- Search bar with Add member button -->
  <div class="search-and-actions">
    <jhi-search-filter-sort-bar
      [searchText]="'researchGroup.members.searchGroupMember' | translate"
      [totalRecords]="filteredMembers().length"
      [singleEntity]="'researchGroup.members.member' | translate"
      [multipleEntities]="'researchGroup.members.members' | translate"
      [showRecordCount]="true"
      (searchOutput)="onSearch($event)"
    />
    <!-- TODO: Add functionality to add members to the research group -->
    <!-- <jhi-button icon="plus" label="researchGroup.members.addMember" [shouldTranslate]="true" severity="primary" (click)="addMember()" /> -->
  </div>

  <!-- Members Table -->
  <div class="table-wrapper">
    <jhi-dynamic-table
      [columns]="columns()"
      [data]="tableData()"
      [totalRecords]="total()"
      [page]="pageNumber()"
      [rows]="pageSize()"
      [selectable]="false"
      (lazyLoad)="loadOnTableEmit($event)"
    />
  </div>

  <!-- Templates for dynamic table -->
  <ng-template #nameTemplate let-member>
    {{ member.name }}
    @if (member.isCurrentUser) {
      <fa-icon icon="circle-user" class="current-user-icon" title="'researchGroup.members.me' | translate" />
    }
  </ng-template>

  <ng-template #deleteTemplate let-member>
    @if (!member.isCurrentUser) {
      <jhi-confirm-dialog
        [label]="'researchGroup.members.remove' | translate"
        severity="danger"
        variant="outlined"
        [header]="'researchGroup.members.removeMemberModal.title' | translate"
        [message]="'researchGroup.members.removeMemberModal.message' | translate"
        (confirmed)="removeMember(member)"
        confirmIcon="trash"
      />
    }
  </ng-template>

  <!-- Add Member Modal -->
  <p-dialog
    [modal]="true"
    [(visible)]="modalVisible"
    [closable]="true"
    [draggable]="false"
    [resizable]="false"
    class="add-member-dialog"
    [style]="{ width: '37.5rem' }"
  >
    <ng-template #header>
      <div class="dialog-header">
        <h2 jhiTranslate="researchGroup.members.addMemberModal.title">Add people to Research Group</h2>
      </div>
    </ng-template>

    <div class="dialog-content">
      <p class="search-instruction" jhiTranslate="researchGroup.members.addMemberModal.searchInstruction">
        Search by username, full name, or email
      </p>

      <jhi-search-filter-sort-bar
        [searchText]="'researchGroup.members.addMemberModal.searchPlaceholder' | translate"
        [singleEntity]="''"
        [multipleEntities]="''"
        [showRecordCount]="false"
      />
    </div>

    <ng-template pTemplate="footer">
      <div class="flex gap-2">
        <jhi-button
          label="researchGroup.members.addMemberModal.cancel"
          [shouldTranslate]="true"
          variant="outlined"
          (click)="closeModal()"
        />
      </div>
    </ng-template>
  </p-dialog>
</div>
