<p-toast />
<p-fileupload name="myfile[]" [multiple]="true" accept="application/pdf" maxFileSize="1000000" (onSelect)="onFileSelected($event)">
  <ng-template #header let-files let-chooseCallback="chooseCallback" let-clearCallback="clearCallback" let-uploadCallback="uploadCallback">
    <div class="flex flex-wrap justify-between items-center flex-1 gap-4">
      <div class="flex gap-2">
        <p-button (onClick)="choose($event, chooseCallback)" icon="pi pi-file-pdf" [rounded]="true" [outlined]="true" />
        <p-button
          (onClick)="uploadEvent(uploadCallback)"
          icon="pi pi-cloud-upload"
          [rounded]="true"
          [outlined]="true"
          severity="success"
          [disabled]="!files || files.length === 0"
        />
        <p-button
          (onClick)="clearCallback()"
          icon="pi pi-times"
          [rounded]="true"
          [outlined]="true"
          severity="danger"
          [disabled]="!files || files.length === 0"
        />
      </div>
      <p-progressbar [value]="totalSizePercent" [showValue]="false" class="w-full" styleClass="md:w-20rem h-1 w-full md:ml-auto">
        <span class="whitespace-nowrap">{{ totalSize() }}B / 1Mb</span>
      </p-progressbar>
    </div>
  </ng-template>

  <ng-template
    #content
    let-files
    let-uploadedFiles="uploadedFiles"
    let-removeFileCallback="removeFileCallback"
    let-removeUploadedFileCallback="removeUploadedFileCallback"
  >
    <div class="flex flex-col gap-8 pt-4">
      @if (files?.length > 0) {
        <div>
          <h5>Pending</h5>
          <div class="flex flex-wrap gap-4">
            @for (file of files; track $index) {
              <div class="p-8 rounded-border flex flex-col border border-surface items-center gap-4">
                <div>
                  <img role="presentation" [alt]="file.name" [src]="file.objectURL" width="100" height="50" />
                </div>
                <span class="font-semibold text-ellipsis max-w-60 whitespace-nowrap overflow-hidden">{{ file.name }}</span>
                <div>{{ formatSize(file.size) }}</div>
                <p-badge value="Pending" severity="warn" />
                <p-button
                  icon="pi pi-times"
                  (click)="onRemoveTemplatingFile($event, file, removeFileCallback, $index)"
                  [outlined]="true"
                  [rounded]="true"
                  severity="danger"
                />
              </div>
            }
          </div>
        </div>
      }
      @if (uploadedFiles?.length > 0) {
        <div>
          <h5>Completed</h5>
          <div class="flex flex-wrap gap-4">
            @for (file of uploadedFiles; track $index) {
              <div class="card m-0 px-12 flex flex-col border border-surface items-center gap-4">
                <div>
                  <img role="presentation" [alt]="file.name" [src]="file.objectURL" width="100" height="50" />
                </div>
                <span class="font-semibold text-ellipsis max-w-60 whitespace-nowrap overflow-hidden">{{ file.name }}</span>
                <div>{{ formatSize(file.size) }}</div>
                <p-badge value="Completed" class="mt-4" severity="success" />
                <p-button
                  icon="pi pi-times"
                  (onClick)="removeUploadedFileCallback($index)"
                  [outlined]="true"
                  [rounded]="true"
                  severity="danger"
                />
              </div>
            }
          </div>
        </div>
      }
    </div>
  </ng-template>

  <ng-template #file></ng-template>

  <ng-template #empty>
    <div class="flex items-center justify-center flex-col">
      <i class="pi pi-cloud-upload !border-2 !rounded-full !p-8 !text-4xl !text-muted-color"></i>
      <p class="mt-6 mb-0">Drag and drop files to here to upload.</p>
    </div>
  </ng-template>
</p-fileupload>
<!-- <button
  class="border border-neutral flex flex-col justify-center rounded-md p-2 w-full h-full"
  (click)="triggerFileInput()"
  (dragover)="onDragOver($event)"
  (dragleave)="onDragLeave($event)"
  (drop)="onDrop($event)"
  [class]="{ 'drag-over': isDragOver(), 'background-disabled': disabled() }"
  [disabled]="disabled()"
>
  <input type="file" (change)="onFileSelected($event)" accept="application/pdf" multiple hidden #fileInput />
  @if (disabled()) {
    @if (documentIds(); as documentIds) {
      <p class="font-bold mt-1 mb-1 text-color">
        {{ documentIds.length }}
        @if (documentIds.length === 1) {
          <span jhiTranslate="entity.upload.uploaded_document"></span>
        } @else if (documentIds.length > 1) {
          <span jhiTranslate="entity.upload.uploaded_documents"></span>
        } @else {}
        <span [jhiTranslate]="`entity.upload.document_type.${ documentType() }`"></span>
      </p>
    }
  } @else {
    <p class="font-bold mt-1 mb-1 text-color" [jhiTranslate]="uploadKey()"></p>
  }
  @if (disabled()) {
    <div class="flex w-full justify-center">
      <span class="flex border items-center justify-center rounded-full border-success size-20">
        <fa-icon [icon]="['fas', 'check']" class="background-success" size="xl" />
      </span>
    </div>
  } @else {
    <div class="flex w-full justify-center">
      <span class="flex border items-center justify-center rounded-full border-primary size-20">
        <fa-icon [icon]="['fas', 'cloud-arrow-up']" class="background-primary" size="xl" />
      </span>
    </div>
    <p class="mt-1 text-sm text-color" jhiTranslate="entity.upload.instruction"></p>
    <p class="mt-1 mb-1 text-xs text-color"><span jhiTranslate="entity.upload.max_size"></span> {{ maxUploadSizeInMb }}MB</p>
  }
  @if (isUploading()) {
    <div><span jhiTranslate="entity.upload.uploaded_progress"></span>{{ uploadProgress() }}%</div>
  }
</button> -->
