<p-fileupload
  [customUpload]="true"
  [multiple]="true"
  accept="application/pdf"
  mode="advanced"
  [maxFileSize]="maxUploadSizeInMb * 1024 * 1024"
  (onClear)="onClear()"
  (onSelect)="onFileSelected($event)"
>
  <ng-template #header let-chooseCallback="chooseCallback" let-uploadCallback="uploadCallback" let-clearCallback="clearCallback">
    <div class="flex flex-wrap gap-2.5 w-full">
      <span [jhiTranslate]="uploadKey()" class="w-full"></span>
      <jhi-button variant="outlined" icon="plus" (click)="chooseCallback()" [label]="'entity.upload.add' | translate" />
      <jhi-button
        variant="outlined"
        icon="upload"
        (click)="onUpload()"
        [label]="'entity.upload.upload' | translate"
        [disabled]="(selectedFiles() ?? []).length === 0"
      />
      <jhi-button variant="outlined" icon="times" (click)="deleteAll()" [label]="'entity.upload.clear' | translate" />
    </div>
  </ng-template>
  <ng-template #empty>
    <div class="flex justify-center gap-0.5">
      <span class="flex border items-center justify-center rounded-full border-primary size-20">
        <fa-icon [icon]="['fas', 'cloud-arrow-up']" class="background-primary" size="xl" />
      </span>
    </div>
    <p class="mt-0 text-sm text-color text-center" jhiTranslate="entity.upload.instruction"></p>
    <p class="mt-0 mb-0 text-xs text-color text-center"><span jhiTranslate="entity.upload.max_size"></span> {{ maxUploadSizeInMb }}MB</p>
  </ng-template>
  <ng-template #content let-files let-removeFileCallback="removeFileCallback">
    <div class="mt-0 w-full">
      <table class="table-fixed border-collapse w-full slim-table">
        <thead>
          <tr>
            <th class="w-1/10"></th>
            <th></th>
            <th class="w-3/20"></th>
            <th class="w-1/10"></th>
          </tr>
        </thead>
        <tbody>
          @if (selectedFiles(); as selectedFiles) {
            @for (file of selectedFiles; track $index) {
              <tr class="border border-gray-400 leading-0 border-x-0">
                <td>
                  <span class="w-full h-full inline-flex justify-center">
                    <fa-icon
                      icon="cloud-arrow-up"
                      class="icon-color-warning"
                      [pTooltip]="'entity.upload.tooltip.to_upload' | translate"
                      tooltipPosition="top"
                    />
                  </span>
                </td>
                <td>
                  <span class="w-full h-full inline-flex justify-center">
                    <input [(ngModel)]="file.name" class="editable-input" />
                  </span>
                </td>
                <td class="text-center">
                  <small class="text-muted">{{ formatSize(file.size) }}</small>
                </td>
                <td>
                  <jhi-button
                    icon="times"
                    severity="danger"
                    variant="text"
                    (click)="removeFileCallback($event, $index)"
                    aria-label="Remove file"
                  />
                </td>
              </tr>
            }
          }
          @if (documentIds(); as documentIds) {
            @for (info of documentIds; track $index) {
              <tr class="border border-gray-400 leading-0 border-x-0">
                <td>
                  <span class="w-full h-full inline-flex justify-center">
                    <fa-icon
                      icon="file-circle-check"
                      class="icon-color-success"
                      [pTooltip]="'entity.upload.tooltip.already_uploaded' | translate"
                      tooltipPosition="top"
                    />
                  </span>
                </td>
                <td>
                  <input [(ngModel)]="info.name" (blur)="renameDocument(info, $event)" class="editable-input" />
                </td>
                <td class="text-center">
                  <small class="text-muted">{{ formatSize(info.size) }}</small>
                </td>
                <td class="border-r-0">
                  <jhi-button icon="trash-alt" severity="danger" variant="text" (click)="deleteDictionary(info)" aria-label="Remove file" />
                </td>
              </tr>
            }
          }
        </tbody>
      </table>
    </div>
  </ng-template>
  <ng-template #file />
</p-fileupload>
