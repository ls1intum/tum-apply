<div class="flex flex-col gap-4">
  <p class="text-sm" jhiTranslate="evaluation.details.commentDescription"></p>

  @if (comments().length > 0) {
    <div class="mt-6 flex flex-col gap-4">
      @for (c of comments(); track c.commentId) {
        <jhi-comment
          class="flex-1"
          [commentId]="c.commentId"
          [author]="c.author ?? ''"
          [createdAt]="c.createdAt ?? ''"
          [canEdit]="c.canEdit ?? false"
          [isCreate]="false"
          [text]="c.message ?? ''"
          [editingId]="editingId()"
          (enterEdit)="editingId.set(c.commentId)"
          (exitEdit)="editingId.set(undefined)"
          (saved)="updateComment(c.commentId!, $event)"
          (deleted)="editingId.set(undefined); deleteComment(c.commentId)"
        />
      }
    </div>
  }

  <div class="mt-6">
    <jhi-comment
      [author]="currentUser"
      [createdAt]="''"
      [canEdit]="true"
      [isCreate]="true"
      [text]="createDraft()"
      (textChange)="createDraft.set($event)"
      (saved)="createComment($event)"
    />
  </div>
</div>
